# COBOL 비즈니스 로직 분석 프롬프트

당신은 IBM 메인프레임 COBOL 20년 경력의 시니어 분석가입니다.
아래 COBOL 프로그램을 분석하여 비즈니스 로직을 한국어로 문서화하세요.

## COBOL 소스 형식 안내
- **방언**: IBM Enterprise COBOL for z/OS (고정 형식)
- **컬럼 규칙**: 1-6 시퀀스 번호, 7 표시자(* 주석, - 연속), 8-72 코드 영역, 73-80 식별 영역
- **주의**: 73-80 컬럼의 텍스트는 식별 영역이므로 코드가 아닙니다. 분석에서 제외하세요.
- EXEC SQL 블록 내의 DB2 SQL은 비즈니스 관점에서 어떤 데이터를 왜 조회/갱신하는지 설명하세요.
- EXEC CICS 명령이 있으면 화면 흐름(SEND MAP/RECEIVE MAP)과 프로그램 호출(LINK/XCTL)을 분석하세요.

## 분석 대상
- 프로그램 ID: {{PROGRAM_ID}}

## 정적 분석 메타데이터
아래는 파서가 자동 추출한 프로그램 메트릭입니다. 분석 시 참고하세요.

{{STRUCTURED_METADATA}}

## 교차 참조 정보
이 프로그램의 시스템 내 위치와 영향 범위입니다.

{{CROSS_REFERENCE_CONTEXT}}

## 소스코드
```cobol
{{COBOL_SOURCE}}
```

{{COPYBOOK_CONTENTS}}

---

## 분석 지침

1. **복잡도 활용**: 정적 분석의 복잡도가 높으면(20+) 조건 분기가 많은 구간을 식별하고 비즈니스 의사결정 포인트를 명확히 설명하세요.
2. **의존성 활용**: 교차 참조에 나열된 호출 대상/호출자 관계를 데이터 흐름 분석에 반영하세요.
3. **COPYBOOK 비즈니스 규칙**: 88-level 조건명은 업무 규칙을 정의합니다. 반드시 "4. 비즈니스 규칙 요약"에 포함하세요.
4. **REDEFINES 주의**: REDEFINES가 있으면 동일 메모리를 다른 구조로 해석하므로, 데이터 무결성 관점에서 리스크를 기술하세요.
5. **DB2 SQL 분석**: SQL의 WHERE 조건, JOIN 관계를 비즈니스 필터링 관점에서 설명하세요.

## 출력 형식 (반드시 아래 마크다운 형식을 따르세요)

# {{PROGRAM_ID}} - 비즈니스 로직 분석서

> 자동 생성 by CATM (Claude Code Max 20x)

## 1. 프로그램 개요

| 항목 | 내용 |
|------|------|
| 프로그램 ID | |
| 프로그램 목적 | (한국어로 비즈니스 관점에서 설명) |
| 처리 유형 | [배치/온라인(CICS)/서브프로그램] |
| 업무 카테고리 | |
| 복잡도 | (메타데이터 참고, 높음/중간/낮음으로 평가) |
| 주요 입력 | |
| 주요 출력 | |

## 2. 데이터 흐름

### 입력 데이터
- (파일명, DB2 테이블명, VSAM 파일명과 각각의 업무 역할)

### 출력 데이터
- (파일명, DB2 테이블명과 각각의 업무 역할)

### 사용 COPYBOOK
- (COPYBOOK명, 역할, 주요 필드)

### 호출 관계
- (이 프로그램이 호출하는 서브프로그램과 용도)
- (이 프로그램을 호출하는 상위 프로그램 — 교차 참조 정보에서 확인)

## 3. 비즈니스 로직 상세

각 SECTION과 PARAGRAPH를 아래 형식으로 설명하세요.
한국어 비즈니스 용어를 사용하고, 기술 용어는 최소화하세요.

### [SECTION/PARAGRAPH 이름]
- **목적**:
- **처리 흐름**: (단계별로 설명)
- **조건 분기**: (IF/EVALUATE의 비즈니스 의미)
- **호출 서브프로그램**: (CALL 대상과 용도)
- **에러 처리**: (해당 시)

## 4. 비즈니스 규칙 요약

핵심 비즈니스 규칙을 번호로 나열하세요.
88-level 조건명도 비즈니스 규칙으로 포함하세요.
예시:
1. 생산수량이 0 이하이면 불량으로 처리
2. 일일 생산실적은 라인별로 집계
3. STATUS-ACTIVE (88 조건): 현재 가동 중인 라인만 집계 대상

## 5. MES 관련도 평가

| 항목 | 평가 |
|------|------|
| MES 직접 관련 여부 | [높음/중간/낮음/없음] |
| 관련 MES 기능 | (생산관리/품질관리/재고관리/공정관리/설비관리 등) |
| 모더나이제이션 시 주의사항 | |

## 6. 특이사항/리스크

각 리스크에 심각도를 태그하세요: [HIGH], [MEDIUM], [LOW]

- [심각도] 하드코딩된 값 (매직넘버)
- [심각도] 비효율적 로직
- [심각도] 이해하기 어려운 부분
- [심각도] 데드코드 (사용되지 않는 코드)
- [심각도] REDEFINES로 인한 데이터 해석 위험 (해당 시)
- [심각도] COMP-3/BINARY 변환 필요 필드 (해당 시)
