# 모더나이제이션 우선순위 - Claude 평가

## 비즈니스 중요도 재산정

| 프로그램 | 기존 점수 | 재산정 | 근거 |
|---------|----------|--------|------|
| PGM001 | 5 | **9** | 전일 생산라인별 실적 집계 및 일일 생산보고서 생성 프로그램으로, MES의 핵심 기능인 **생산실적 관리**에 직접 해당. PROD-TRANS-FILE → DB2 TB_DAILY_PROD 집계는 MES 생산실적 모듈의 근간이 됨. |
| .GITKEEP | - | **제외** | 실제 COBOL 프로그램이 아닌 디렉토리 구조 유지용 파일. 분석/전환 대상에서 완전 제외해야 함. |

> **참고**: .GITKEEP은 `find_files()`에서 필터링되어야 하는 항목이 Phase 5 분석에 유입된 것으로, 파이프라인 필터링 로직을 재점검할 필요가 있습니다.

---

## Phase 배정

### Phase 1 (즉시 전환, 0-3개월)

- **PGM001** (일일 생산실적 집계)
  - MES 핵심 기능인 생산실적 집계를 담당하며, 비즈니스 중요도 9점
  - 기술 복잡도 10점이지만, 전환 용이성 7점으로 자동 변환 가능 범위
  - DB2 연동(TB_DAILY_PROD), VSAM KSDS 입력, COPYBOOK 2개(CPYTRANS, CPYSMRY) 구조가 명확
  - CICS 미사용(배치 프로그램)으로 온라인 트랜잭션 복잡성 없음
  - MES 구축 시 생산실적 데이터가 다른 모든 모듈(품질, 설비, 재고)의 기반이 되므로 최우선 전환 필요

### Phase 2 (3-6개월) / Phase 3 (6-12개월)

- 현재 분석 대상 프로그램이 PGM001 1건이므로 해당 없음
- 추가 COBOL 프로그램 스캔 후 배정 필요

---

## 전환 순서 권장

### PGM001 전환 전략

| 항목 | 권장 |
|------|------|
| **전환 방식** | **하이브리드** (자동 변환 + 수동 검증) |
| **기존 권장** | 자동 변환 |
| **변경 근거** | 아래 참조 |

**자동 변환에서 하이브리드로 상향 조정하는 이유:**

1. **DB2 SQL 연동**: TB_DAILY_PROD 테이블에 대한 UPDATE 로직이 포함되어 있어, SQL 마이그레이션(DB2 → 타겟 RDBMS) 시 수동 검증 필수
2. **VSAM KSDS 입력**: 복합 키(공장코드+라인코드+생산일자+순번) 구조의 VSAM 파일 접근을 현대적 데이터 소스(API/DB)로 전환 시 I/O 로직 재설계 필요
3. **집계 로직 정합성**: 생산실적 총수량/총건수/오류건수 집계는 MES 데이터 정확성의 기반이므로 단위 테스트를 통한 수치 검증이 반드시 필요

### 전환 선후행 관계

```
1. COPYBOOK 전환 (CPYTRANS, CPYSMRY, DCLTBPROD)
   → 데이터 구조 정의가 선행되어야 프로그램 전환 가능
   
2. DB2 테이블 마이그레이션 (TB_DAILY_PROD)
   → 타겟 RDBMS 스키마 확정 후 DDL 전환

3. PGM001 프로그램 전환
   → COPYBOOK + DB 스키마 확정 후 프로그램 로직 전환

4. 하위 호출 프로그램 전환 (ERRLOG, SQLERR, ABNDPGM)
   → PGM001이 CALL하는 3개 서브프로그램도 함께 전환 필요
   → 이들이 다른 프로그램에서도 공유되는 공통 모듈이면 최우선 전환
```

---

## 리스크 및 주의사항

### 높은 리스크

1. **분석 데이터 오염**: `.GITKEEP` 파일이 분석 파이프라인에 유입되어 Phase 5/6 결과를 오염시키고 있음. `05_analyze_with_claude.py`의 입력 파일 필터링을 강화해야 함 (현재 `find_files()`에서 제외하도록 수정된 상태이나, 기존 output에 잔재가 남아있을 수 있음)

2. **CALL 대상 프로그램 누락**: PGM001이 호출하는 ERRLOG, SQLERR, ABNDPGM 3개 프로그램이 분석 대상에 포함되지 않음. 이들의 소스가 `src/` 디렉토리에 존재하는지 확인 필요. 없을 경우:
   - 메인프레임에서 추가 추출 필요
   - 또는 MES 타겟 환경에서 동등 기능 신규 개발 필요

3. **단일 프로그램 분석 한계**: 현재 PGM001 1건만 분석되어 있어, 프로그램 간 의존성 그래프와 전환 임팩트를 정확히 평가하기 어려움

### 중간 리스크

4. **DB2 → 타겟 DB 전환**: TB_DAILY_PROD 테이블의 SQL 호환성 검증 필요 (특히 COBOL 호스트 변수 바인딩, COMP-3 데이터 타입 매핑)

5. **배치 스케줄링 전환**: JCL 기반 배치 스케줄링을 현대적 스케줄러(Airflow, Spring Batch 등)로 전환 시 DD 이름 매핑(PRODTRAN, DLYSMRY) 및 파일 핸들링 재설계 필요

### 권장 후속 조치

1. `src/` 디렉토리에 추가 COBOL 소스를 배치하고 전체 파이프라인(`./catm.sh`) 재실행
2. ERRLOG, SQLERR, ABNDPGM 소스 확보 및 분석
3. 전체 프로그램 목록 확보 후 의존성 그래프 기반 전환 순서 재산정
4. `.GITKEEP.md` 분석 결과물을 `output/docs/`에서 삭제하여 데이터 정합성 확보