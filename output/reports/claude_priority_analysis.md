# 모더나이제이션 우선순위 - Claude 평가

## 비즈니스 중요도 재산정

| 프로그램 | 기존 점수 | 재산정 | 근거 |
|---------|----------|--------|------|
| PGM001 | 5 | **8** | 전일 생산라인별 실적 집계 → 일일 생산보고서 생성 프로그램. MES의 핵심 기능인 **생산실적 집계·보고** 영역에 해당. VSAM 트랜잭션 → DB2(TB_DAILY_PROD) 갱신 구조로, MES 생산실적 모듈의 직접적 전환 대상. |
| PGM002 | 5 | **7** | 입출고 트랜잭션 → 재고 마스터 갱신 + 수불대장 생성. MES **자재·재고관리** 영역의 주요 기능. 재고 정합성은 생산계획·자재소요량 산출의 기반이므로 MES 운영에 필수적이나, 핵심 생산실적보다는 한 단계 아래. |

---

## Phase 배정

### Phase 1 (즉시 전환, 0-3개월)

- **PGM001 (일일생산집계)**
  - MES 핵심 생산실적 기능으로 최우선 전환 대상
  - 상대적으로 낮은 복잡도 (116행, complexity 12)
  - DB2 테이블 1개(TB_DAILY_PROD)만 사용하여 데이터 마이그레이션 범위 제한적
  - CICS 미사용으로 온라인 연동 고려 불필요

### Phase 2 (중기, 3-6개월)

- **PGM002 (재고수불처리)**
  - 재고관리는 MES 주요 기능이나, PGM001(생산실적)이 안정화된 후 전환하는 것이 안전
  - 높은 기술 복잡도 (167행, complexity 18, CALL 4건, COPY 3건)
  - 재고 마스터 I-O 모드(READ/WRITE/REWRITE) 사용으로 데이터 무결성 검증이 까다로움
  - DB2 INSERT(TB_INV_SUMMARY) + 다중 파일 동시 처리로 트랜잭션 관리 주의 필요

---

## 전환 순서 권장

```
PGM001 (생산실적 집계)  ──→  PGM002 (재고수불 처리)
         Phase 1                      Phase 2
```

**선후행 근거:**

1. **PGM001 선행 필수**: 생산실적 데이터(TB_DAILY_PROD)는 재고 입출고의 근거가 됨. 생산 완료 수량이 확정되어야 입고 트랜잭션의 정합성 검증이 가능.
2. **PGM002 후행**: 재고수불 처리는 생산실적 외에도 외부 입출고 데이터에 의존하므로, 생산실적 모듈 안정화 후 전환 시 테스트 범위를 줄일 수 있음.

---

## 전환 전략 상세

### PGM001 — 자동 변환 + 부분 리라이트

| 항목 | 내용 |
|------|------|
| 전환 방식 | **하이브리드** (자동 변환 기반 + DB2 접근부 리라이트) |
| 근거 | 배치 집계 로직은 자동 변환 가능하나, DB2 UPDATE(TB_DAILY_PROD) 부분은 MES의 신규 DB 스키마에 맞춰 리라이트 필요 |
| 주의사항 | - VSAM KSDS → 신규 데이터소스 전환 시 키 구조(공장+라인+일자+일련번호) 매핑 검증 필수 |
| | - COMP-3(패킹 십진수) 필드의 정밀도 보존 확인 |
| | - 일자 처리 로직의 경계값 테스트 (월말, 연말) |

### PGM002 — 하이브리드 (자동 변환 + 핵심 로직 리라이트)

| 항목 | 내용 |
|------|------|
| 전환 방식 | **하이브리드** (기존 평가의 "자동 변환"에서 상향 조정) |
| 근거 | 재고 마스터 RANDOM 접근 + REWRITE 패턴, 다중 CALL(4건), 높은 복잡도를 고려하면 순수 자동 변환은 위험 |
| 주의사항 | - 재고 마스터 I-O 모드의 동시성 제어 → MES에서는 DB 트랜잭션으로 전환 필요 |
| | - 수불대장(LEDGER) 생성 로직의 전재고/현재고 계산 정합성 검증 |
| | - 4건의 CALL 대상 서브프로그램 식별 및 동시 전환 또는 인터페이스 래퍼 필요 |
| | - 거래유형별 분기(입고/출고/반품/조정 등) 로직의 완전한 테스트 케이스 확보 |

---

## 리스크 및 주의사항

### 데이터 마이그레이션 리스크
- **DB2 테이블 스키마 변경**: TB_DAILY_PROD, TB_INV_SUMMARY의 MES 신규 스키마 매핑 시 컬럼 타입·길이 불일치 가능성
- **VSAM → RDB 전환**: KSDS 키 구조 기반의 순차/랜덤 접근 패턴을 SQL 기반으로 재설계 필요
- **COMP-3 데이터 정밀도**: 패킹 십진수 → 부동소수점 전환 시 금액·수량 정밀도 손실 주의

### 운영 연속성 리스크
- **병행 운영 기간**: Phase 1 전환 중 기존 COBOL 배치와 신규 MES 모듈이 동일 DB2 테이블을 참조할 경우 데이터 충돌 가능
- **배치 윈도우**: 일일 배치 처리 시간대와 MES 실시간 처리 간의 간섭 방지 설계 필요

### 의존성 리스크
- **PGM002의 4건 CALL**: 서브프로그램이 미식별 상태. 전환 전 반드시 서브프로그램 목록을 확정하고, 동시 전환 또는 래퍼 전략 수립 필요
- **COPYBOOK 공유**: CPYTRANS 등 공유 COPYBOOK이 다른 프로그램에서도 사용되는지 확인하여, 구조 변경 시 영향 범위 파악 필요

### 테스트 리스크
- **회귀 테스트 범위**: 기존 COBOL 결과와 신규 MES 모듈 결과의 1:1 대조 검증 체계 구축 필수
- **경계값·예외 처리**: COBOL의 묵시적 데이터 절삭(truncation), 부호 처리 등이 신규 언어에서 동일하게 동작하는지 검증