# 모더나이제이션 우선순위 - Claude 평가

## 구조화된 점수 (파싱용 JSON)

```json
{
  "scores": {
    "PGM003": {"business_importance": 9, "phase": 1, "reason": "MES 핵심 품질관리 기능 - 실시간 합격/불합격 판정, 불량률 산출, 경보 시스템"},
    "PGM001": {"business_importance": 8, "phase": 1, "reason": "MES 핵심 생산실적 집계 - 일일 생산보고서 생성 및 라인별 실적 추적"},
    "PGM002": {"business_importance": 7, "phase": 2, "reason": "MES 주요 재고수불 관리 - 입출고 처리 및 재고 마스터 갱신, 수불대장 생성"}
  }
}
```

## 비즈니스 중요도 재산정

| 프로그램 | 기존 점수 | 재산정 | 근거 |
|---------|----------|--------|------|
| PGM003 | 5 | **9** | 품질검사 판정(합격/불합격/재작업), 불량률 산출, 치명적 불량 즉시 경보(QCALERT) 등 MES 품질관리의 핵심 기능. 재작업 3회 초과 시 불합격 전환 같은 비즈니스 룰이 MES 공정 품질 제어에 직결됨 |
| PGM001 | 5 | **8** | 생산라인별 일일 실적 집계 및 DB2 동기화는 MES 생산실적 관리의 기반. 온라인 생산현황 조회의 데이터 소스 역할을 하며, 모든 생산 KPI의 원천 |
| PGM002 | 5 | **7** | 입출고 트랜잭션 기반 재고 마스터 실시간 갱신, 수불대장 생성은 MES 자재관리에 중요하나, 생산실적/품질관리 대비 우선순위는 한 단계 낮음 |

> **기존 점수(5)가 일괄 동일했던 이유**: 정적 분석 단계에서 비즈니스 로직을 반영하지 못한 기본값이었음. Claude 비즈니스 로직 분석 결과를 반영하여 MES 관점의 실질적 중요도로 재산정함.

## Phase 배정

### Phase 1 (즉시 전환, 0-3개월)

- **PGM001** (생산실적 집계)
  - MES의 가장 기본적인 데이터 파이프라인
  - 구조가 단순 (116라인, 복잡도 12)하여 전환 용이
  - 다른 프로그램이 생산실적 데이터에 의존할 가능성 높음
  - TB_DAILY_PROD 테이블이 온라인 조회의 데이터 소스 → 조기 전환 필요

- **PGM003** (품질검사 관리)
  - MES 품질관리 핵심이나 복잡도가 높음 (179라인, 복잡도 27)
  - QCALERT 경보 시스템 연동이 있어 PGM001 다음에 착수
  - 불량률 관리는 MES 운영의 즉각적 가치 창출 영역

### Phase 2 (중기, 3-6개월)

- **PGM002** (재고수불 관리)
  - 3개 파일 동시 처리(트랜잭션/마스터/대장) + DB2로 가장 복잡한 I/O 패턴
  - 재고 마스터 I-O 모드 갱신, 신규 품목 자동 등록 등 데이터 무결성 요구 높음
  - PGM001(생산실적)이 선행 전환되어야 생산-재고 연계 검증 가능
  - 의존성 영향도(10.0)가 가장 높아 신중한 전환 필요

## 전환 순서 권장

```
PGM001 (생산실적) ──→ PGM003 (품질검사) ──→ PGM002 (재고수불)
  [Phase 1 초기]        [Phase 1 후기]        [Phase 2]
```

**선후행 근거:**

1. **PGM001 → 가장 먼저**: 생산실적은 MES의 기초 데이터. 구조가 가장 단순(VSAM 입력 → 집계 → DB2 UPDATE)하여 전환 파일럿으로 적합. 전환 과정에서 팀 학습효과 확보
2. **PGM003 → 두 번째**: 품질관리는 생산실적과 함께 MES 핵심이지만, 복잡도가 높고(EVALUATE 분기, QCALERT 연동, 재작업 횟수 기반 상태 전환) PGM001 전환 경험을 활용해야 함
3. **PGM002 → 마지막**: 의존성 영향도가 가장 높고(10.0), 3개 파일 동시 I/O + 랜덤 액세스 마스터 갱신이라는 복잡한 패턴. 생산실적 데이터가 안정화된 후 전환해야 연계 검증 가능

## 전환 전략 권장

| 프로그램 | 전환 방식 | 상세 |
|---------|----------|------|
| PGM001 | **자동 변환** | 직선적 배치 흐름(READ→집계→WRITE→UPDATE), EVALUATE 분기가 단순. COBOL-to-Java/Python 자동 변환 도구 적용 가능 |
| PGM003 | **하이브리드** | 메인 흐름은 자동 변환하되, 불량률 계산 로직·재작업 횟수 기반 판정 전환·QCALERT 연동은 수동 리라이트. 비즈니스 룰이 복잡하여 자동 변환만으로 품질 보장 어려움 |
| PGM002 | **자동 변환** | 배치 패턴이 정형적이나, I-O 모드 마스터 갱신·재고 부족 시 경보(STKALERT)·수불대장 동시 기록은 전환 후 집중 검증 필요 |

## 리스크 및 주의사항

### 공통 리스크
- **DB2 테이블 스키마 전환**: 3개 프로그램 모두 DB2 사용. 테이블 구조 마이그레이션을 먼저 확정하고 전환 착수해야 함
- **ERRLOG 서브프로그램 의존**: PGM001, PGM003 모두 ERRLOG를 CALL. 이 공통 모듈의 전환/대체를 선행하거나 인터페이스를 먼저 확정해야 함
- **VSAM → DB/파일시스템 전환**: 3개 프로그램 모두 VSAM 파일 사용. VSAM 키 구조(복합키)를 새로운 데이터 소스에 정확히 매핑해야 함

### 프로그램별 주의사항
- **PGM001**: CURRENT DATE 사용 부분의 시간대(timezone) 처리 확인. 배치 실행 시점과 날짜 경계 로직 검증
- **PGM002**: 재고 마스터 I-O 모드 갱신 시 동시성 제어 필요. 수불대장의 전량/후량 계산 정확성이 감사 요건과 직결됨. 수불대장 파일(WS-FILE-STATUS3) 오픈 상태를 검증하지 않는 기존 결함이 있으므로 전환 시 오류 처리 보강
- **PGM003**: 재작업 3회 초과 시 불합격 전환 룰은 비즈니스 검증 필수. QCALERT 경보 시스템 인터페이스를 MES 알림 체계로 매핑해야 함. 측정값 상하한 비교 로직의 정밀도 보존 확인

### 전체 전략 권고
- **병렬 테스트 환경** 구축: 전환된 프로그램과 기존 COBOL을 동시 실행하여 결과 비교(shadow run) 수행
- **COPYBOOK 기반 데이터 모델 선행 확정**: CPYTRANS, CPYQCRS, CPYINVTR 등의 레코드 구조를 새로운 데이터 모델로 먼저 매핑
- **공통 모듈 우선 전환**: ERRLOG, QCALERT, STKALERT 등 서브프로그램을 API/서비스로 먼저 전환하여 메인 프로그램 전환 시 안정적 연동 보장